<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-38205696-1']);
            _gaq.push(['_trackPageview']);
            
            (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
        </script>
        
        <meta charset="utf-8">
        <meta name="description" content="Web Front-End Blog by Wenli Zhang" />
        
        <link rel="shortcut icon" href="/blog/img/me.ico">
            
        <link rel="stylesheet" type="text/css" href="/blog/css/syntax.css" />
        <link rel="stylesheet" type="text/css" href="/blog/css/default.css" />
        
        
        <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
            
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
        <script type="text/javascript" src="/blog/js/lazyLoad.js"></script>
        <script type="text/javascript" src="/blog/js/common.js"></script>
    </head>
    
    <body>        
        <div id="contentDiv">


<title>Sorting In JavaScript
	
</title>
 
<a href="http://zhangwenli.com/blog">
    <div id="homeDiv"></div>
</a>
<div class="rotLeft rotTop pageBack"></div>
<div class="rotRight rotTop pageBack"></div>
<div class="container page">
    <div class="simpleNav">
        <a href="http://zhangwenli.com" class="pageDiv">Home</a>
        <a href="http://zhangwenli.com/blog" class="pageDiv">Blog</a>
    </div>
    
    <div class="pageTitle">Sorting In JavaScript</div>
	
	
    
    <div class="time">2013.11.02 14:39</div>
            
    <div id="tagPanel">
    
        <div class="tag">JavaScript</div>
    
    </div>
    
    <p>Method of sorting an array is defined in <code>Array.prototype.sort</code>. So in most cases, you don't have to think about how to implement a sort algorithm when writing in JavaScript. But you still need to be careful when you use it, since JavaScript is fragile. :disappointed:</p>

<h1>What's The Problem?</h1>

<p>JavaScript provides sorting method for <code>Array</code> type, so that you don't have to write it by yourself.</p>

<p>Don't celebrate too early! JavaScript may not behave in the way you think it should. :fearful:</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">];</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">colors</span><span class="p">.</span><span class="nx">sort</span><span class="p">());</span>    <span class="c1">// [&quot;blue&quot;, &quot;green&quot;, &quot;red&quot;, &quot;white&quot;, &quot;yellow&quot;]</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">colors</span><span class="p">);</span>           <span class="c1">// [&quot;blue&quot;, &quot;green&quot;, &quot;red&quot;, &quot;white&quot;, &quot;yellow&quot;]</span>
</code></pre>
</div>


<p>Two things we can know from the above example are: Firstly, <code>String</code> type is sorted in an alphabetic order. Secondly, <code>sort()</code> method changes the original array rather than generating a new array.</p>

<p>But it's not sorted in <em>an alphabetic order</em> in fact.</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;Yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;White&#39;</span><span class="p">];</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">colors</span><span class="p">.</span><span class="nx">sort</span><span class="p">());</span>    <span class="c1">// [&quot;White&quot;, &quot;Yellow&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;red&quot;]</span>
</code></pre>
</div>


<p>It compares by each character's <a href="http://www.asciitable.com/" target="_blank">ASCII code</a> so that uppercase letters are always <em>smaller</em> than lowercase ones.</p>

<p>Another thing you need to be careful with is when you sort an array with numbers.</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">money</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mi">200</span><span class="p">];</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">money</span><span class="p">.</span><span class="nx">sort</span><span class="p">());</span>    <span class="c1">// [12, 200, 3, 7.4]</span>
</code></pre>
</div>


<p>:open_mouth: Surprise?</p>

<h1>Why</h1>

<p>By default, the <code>sort()</code> method converts <em>everything</em> into <code>String</code> and then compares letter by letter. You may wonder why JavaScript isn't smart enough to tell this is an array of numbers and then sort it by numbers' value.</p>

<p>But if you think twice, you may find that an array can contain different types in JavaScript, so what do you expect to get from the following sorted array?</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">everything</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;$200&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="kc">false</span><span class="p">];</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">everything</span><span class="p">.</span><span class="nx">sort</span><span class="p">());</span>
</code></pre>
</div>


<p>Although I doubt it's a good idea to put all these different types together in an array, this is totally legal in JavaScript. If you think <code>12</code> should be thought as <em>larger</em> than <code>7.4</code>, then, how to sort the whole array?</p>

<p>OK. Here's how JavaScript deals with it: Convert to <code>String</code> and compare letter by letter in ASCII code order. So <code>true</code> is converted to <code>"true"</code> and <code>false</code> is converted to <code>"false"</code> when comparing.</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">everything</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;$200&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="kc">false</span><span class="p">];</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">everything</span><span class="p">.</span><span class="nx">sort</span><span class="p">());</span> 
<span class="c1">// [&quot;$200&quot;, 0.3, 12, 7.4, &quot;Red&quot;, false, true, &quot;white&quot;]</span>
</code></pre>
</div>


<h1>Comparing Function</h1>

<p>Sorting arrays with numbers only is still a very common need. So how can I sort them by comparing numbers' value?</p>

<p>Pass a comparing function to it!</p>

<h2>Comparing Numbers</h2>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">money</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mi">200</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">compare</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">;};</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">money</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">compare</span><span class="p">));</span> <span class="c1">// [3, 7.4, 12, 200]</span>
</code></pre>
</div>


<p>Now, you get what you wanted. :grinning:</p>

<p>What happens here is that <code>compare</code> function takes two element and returns a negative number if <code>a</code> is smaller than <code>b</code>, <code>0</code> if <code>a</code> is equal to <code>b</code>, a positive number if <code>a</code> is larger than <code>b</code>.</p>

<h2>Comparing Objects</h2>

<p>Comparing function is also useful when we compare objects. Let's say that we want to sort people by their <code>id</code> rather than their <code>name</code>, we can define a function to compare people by <code>id</code>.</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">people</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Alice&#39;</span><span class="p">,</span>
    <span class="nx">id</span><span class="o">:</span> <span class="mi">1234</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span>
    <span class="nx">id</span><span class="o">:</span> <span class="mi">567</span>
<span class="p">}];</span>
<span class="kd">var</span> <span class="nx">compare</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">id</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">id</span><span class="p">;}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">people</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">compare</span><span class="p">));</span> <span class="c1">// Bob is before Alice now</span>
</code></pre>
</div>


<h2>Compare Everything</h2>

<p>What if we sort <code>everything</code> with <code>compare</code>?</p>

<div class="highlight"><pre><code class="js"><span class="kd">var</span> <span class="nx">everything</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;$200&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="kc">false</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">compare</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">;};</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">everything</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">compare</span><span class="p">));</span> 
</code></pre>
</div>


<p>Chrome and Opera: <code>[4, "Red", "$200", "white", false, 0.3, true, 7.4, 12]</code>;</p>

<p>Firefox: <code>[false, 0.3, true, 4, "Red", "$200", "white", 7.4, 12]</code>;</p>

<p>IE: <code>["Red", "$200", false, 0.3, true, 4, "white", 7.4, 12]</code>.</p>

<p>This is so weird! :scream:</p>

<p>When comparing, <code>a - b</code> is calculated in <code>compare</code> so that every element in <code>everything</code> is converted to <code>Number</code> when comparing and then do the minus operation. As <code>Number('Red')</code>, <code>Number('$200')</code> and <code>Number('white')</code> give <code>NaN</code> all, comparing function <code>compare</code> returns <code>NaN</code> when they compare to any other element. With the existance of this <code>NaN</code>, the behavior of <code>Array.prototype.sort</code> is not defined in the <a href="http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.11" target="_blank">ECMA Specification</a>, so it depends on each platform's implementation.</p>

<blockquote><p>Calling <code>comparefn(a,b)</code> always returns the same value <code>v</code> when given a specific pair of values <code>a</code> and <code>b</code> as its two arguments. Furthermore, <code>Type(v)</code> is <code>Number</code>, and <code>v</code> is not <code>NaN</code>. Note that this implies that exactly one of <code>a &lt;CF b</code>, <code>a =CF b</code>, and <code>a &gt;CF b</code> will be true for a given pair of a and b.</p>

<p><a href="http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.11" target="_blank"><em>ECMA 262 Specification</em></a></p></blockquote>

<p>The lesson learned here is that the behavior of sorting with a comparing function that will return <code>NaN</code> is unpredictable and you should be careful when choosing a suitable comparing function. Again, it's not a good idea to put everything with different types all together in the same array.</p>

	
	
    
    <div class="license">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">
            <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc/3.0/88x31.png" />
        </a>
        <div><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Every blog post in this site</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://zhangwenli.com" property="cc:attributionName" rel="cc:attributionURL">Wenli Zhang</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>, based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="http://github.com/ovilia/blog" rel="dct:source">http://github.com/ovilia/blog</a>. </div>
        <div>You must reference <code>Author: &lt;a href=&quot;http://zhangwenli.com&quot;&gt;Wenli Zhang&lt;/a&gt;</code> explictly along with this license note if you want to re-post the content, either completely or partially.</div>
    </div>
    
    <div class="olderNewer">
        
            <div class="olderPost">
                <a href="http://zhangwenli.com/blog/2013/10/24/rss-is-now-available/">Older: RSS Is Now Available!</a>
            </div>
        
        
            <div class="newerPost">
                <a href="http://zhangwenli.com/blog/2013/12/03/learning-list-for-2014/">Newer: Learning List for 2014</a>
            </div>
        
        <div class="recentPost">
            <a href="http://zhangwenli.com/blog">Recent Posts</a>
        </div>
    </div>
    
    <h1>Comments</h1>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'wenli'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>
<div class="rotLeft rotBottom pageBack"></div>
<div class="rotRight rotBottom pageBack"></div>

        </div>
        
        <div id="footerDiv">
            <div id="footerImg"></div>
            <div id="footerCnt">
                <div id="footer">
                </div>
            </div>
        </div>
    </body>
</html>

 
